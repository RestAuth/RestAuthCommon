#!/usr/bin/make -f

PYVERS=$(shell pyversions -rv) $(shell py3versions -rv)

pkgdir = $(CURDIR)/debian/python$(if $(patsubst 3.%,,$(1)),,3)-restauth-common

%:
	dh $@ --with python3,python2

override_dh_installchangelogs:
	dh_installchangelogs ChangeLog

install-python%:
	dh_testdir
	python$* setup.py install --force --root $(call pkgdir,$*) --no-compile -O0 --install-layout=deb

build-python%:
	dh_testdir
	python$* setup.py build

override_dh_auto_build: ${PYVERS:%=build-python%}
	dh_testdir
	python setup.py build_doc

	#dh_auto_build

override_dh_auto_install: ${PYVERS:%=install-python%}
	#dh_auto_install

test-python%:
	python$* setup.py test

ifeq (,$(findstring nocheck,$(DEB_BUILD_OPTIONS)))
override_dh_auto_test: ${PYVERS:%=test-python%}
endif
